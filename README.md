## Graph Isomorphism Network as Custom Task

Example of custom task graph neural net

see [this notebook](https://github.com/timsetsfire/odsc-ml-drum/blob/main/Colab%20-%20Graph%20Isomorphism%20Network.ipynb) for some more details.  

The important piece to this is the datasdt.  The file `graph2.csv` has two columns: `dgl_graph` and `labels`.  You could use this for any graph classification problem using the [DGL](https://github.com/dmlc/dgl) framework provided that the column `dgl_graph` is a dgl graph, serialized, the labels is a binary column.  

For example, if `g` is a list of dgl graphs, and `l` is a list of labels, then the dataset would be generated by

```
import pandas as pd
import pickle
g_pkl = [ pickle.dumps(graph) for graph in g]
df = pd.DataFrame(g_pkl, columns = ["dgl_graph"])
df["label"] = l
df.to_csv("graph2.csv")
```

TODO: instead of using DGL graphs, will work to use networkx and then convert these to DGL (maybe by way of another custom task).  

you may fit with drum via 

`drum fit --code-dir custom-task-dnn --input graph2.csv --target labels --target-type binary --docker pytorch-env --output custom-task-dnn-fit`

and score with drum via

`drum score --code-dir custom-task-dnn-fit --input graph2.csv --positive-class-label 1 --negative-class-label 0 --target-type binary --docker pytorch-env`
